# 介绍

## 总览

Vite (法语意为 "快速的"，发音 `/vit/`) 是一种新型前端构建工具，能够显著提升前端开发体验，它主要由两部分组成：

- 提供 [原生 ES Modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules) 源文件的开发服务器，并附带 [丰富的内建功能](./features) 和速度惊人的 [模块热重载（HMR）](./features#hot-module-replacement)。

- 一套 [构建指令](./build) 使用 [Rollup](https://rollupjs.org) 打包你的代码，预配置输出高度优化的静态资源用于生产。

此外，Vite 通过它的 [插件 API](./api-plugin) 和 [JavaScript API](./api-javascript) 具有高度的可扩展性，并支持全类型。

## 为什么使用原生 ESM

今天大多数的 JavaScript 开发者都对下面的 ES 模块语法比较熟悉了：

```js
import { foo } from './other-module'
```

时至今日，这种语法已经在主流浏览器中得到了广泛的原生支持。然而，在浏览器拥有对 ES 模块的原生支持之前，我们不得不依赖于打包工具（Browserify, webpack, Parcel 或 Rollup）将所有模块源代码合并到一个文件中，以便浏览器能够提供服务，甚至在开发过程中也是如此。

在开发过程中打包存在两个缺点:

- **开发服务器启动慢** 当启动开发服务器时，打包程序总是不顾一切地打包整个应用程序，即使代码存在可分割点。例如，在一个有 12 条路由的应用中，每条路由都是懒加载的，你仍然需要等待打包程序处理你应用中的每一个文件，然后你才能开始处理单个路由页面。

  ![基于打包器的开发服务器](/images/bundler.png)

  **Vite 是如何解决的：** 在服务器启动时不需要做任何准备工作 —— Vite 只是简单地编译并按需提供来自浏览器的请求文件。在代码分割的应用程序中，只需要服务当前路由页面使用的模块。

  ![基于 ESM 的开发服务器](/images/esm.png)

- **更新慢** 当一个文件被编辑时，除了重新构建文件本身之外，打包程序还需要使其模块图的一部分失效，并重新构建整体。这意味着保存文件和查看浏览器中反映的变化之间的反馈速度随着应用程序的大小增长而直线下降。在大型应用程序中，即使启用了模块热重载，这个步骤也会变得代价非常高。

  **Vite 是如何解决的：** 每个服务的文件都通过 HTTP 头缓存（304 Not Modified），如果浏览器缓存被禁用，Vite 将使用内存缓存。在文件编辑时，我们只需使该文件的缓存无效。此外，原生 ESM 上进行 [模块热重载](./features#hot-module-replacement) 只需要准确地重新获取失效的模块，无论应用程序的大小如何，都能始终保持快速。

一旦你体验到 Vite 有多快，我们有理由怀疑你是否愿意再忍受使用打包器开发。

## 为什么生产环境仍需打包

尽管原生 ESM 现在得到了广泛支持，但由于嵌套导入会导致额外的网络往返，在生产环境中发布未打包的 ESM 仍然效率低下（即使使用 HTTP/2）。为了在生产环境中获得最佳的加载性能，最好还是将代码进行 tree-shaking、懒加载和 chunk 分割（以获得更好的缓存）。

要确保开发服务器和产品构建之间的最佳输出和行为一致并不容易。所以 Vite 附带了一套预配置的[构建命令](./build)，开箱即用。

## 浏览器支持

- Vite 需要在支持 [原生 ES 模块动态导入](https://caniuse.com/es6-module-dynamic-import) 的浏览器中使用。

- 生产版本通过脚本标签来对 [原生 ES 模块](https://caniuse.com/es6-module) 提供基本支持，并且可以通过官方插件支持传统浏览器。有关更多细节，详见 [构建生产版本](./build)。
